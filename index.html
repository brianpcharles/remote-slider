<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Remote Slider Demo</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" />
  <link rel="stylesheet" href="./remote-slider.css" />
    <style>
      body { font-family: system-ui, Arial, sans-serif; margin: 2rem; }
      #gallery { border: 1px solid #ccc; padding: 8px; min-height: 300px; }
      .config-block { margin-bottom: 1rem; }
      textarea { width: 100%; height: 160px; font-family: monospace; }
      button { cursor: pointer; margin-right: .5rem; }
    </style>
  </head>
  <body>
    <h1>Remote Slider Demo</h1>
    <p>Edit config JSON and mount the slider.</p>
    <div class="config-block">
      <label for="configInput"><strong>Config JSON:</strong></label>
      <textarea id="configInput">{
  "slidesUrl": "https://example.com/cloudinary-slides.json",
  "resourcePath": {
    "image": "https://res.cloudinary.com/demo/image/upload/",
    "video": "https://res.cloudinary.com/demo/video/upload/"
  },
  "transformations": {
    "image": "c_fit,w_800/",
    "gif": "c_fit,w_800/",
    "video": "c_fit,w_800/",
    "thumbnail": "c_fill,w_160,h_160/"
  },
  "thumbnails": {
    "breakpoint": 768,
    "desktop": { "enabled": true, "direction": "vertical" },
    "mobile": { "enabled": false }
  },
  "desktopCrop": { "width": "800px", "height": "600px" },
  "mobileCrop": { "width": "100%", "height": "400px" },
  "imageProps": { "objectFit": "cover", "lazyLoad": true },
  "videoProps": { "autoplay": true, "muted": true, "loop": true, "playsInline": true }
}</textarea>
      <div>
        <button id="mountBtn">Mount</button>
        <button id="remountBtn">Remount</button>
        <button id="unmountBtn">Unmount</button>
      </div>
    </div>
    <div id="gallery"></div>

  <!-- Standalone build: single script includes React, ReactDOM, Swiper -->
  <script src="./remote-slider.umd.js" id="remoteSliderScript"></script>
      <script>
        // Diagnostic: log when remote slider script loads or fails
        (function(){
          var s = document.getElementById('remoteSliderScript');
          if(!s){ console.warn('[Demo] remote-slider script tag missing'); return; }
          s.addEventListener('load', function(){
            console.log('[Demo] remote-slider script loaded. window.RemoteSlider keys:', window.RemoteSlider && Object.keys(window.RemoteSlider));
          });
          s.addEventListener('error', function(e){
            console.error('[Demo] remote-slider script failed to load', e);
          });
        })();
      </script>
    <script>
      function parseConfig() {
        try { return JSON.parse(document.getElementById('configInput').value); } catch (e) { console.error('Invalid JSON', e); return null; }
      }
        function ensureReady(fn){
          if(window.RemoteSlider){ fn(); return; }
          console.warn('[Demo] RemoteSlider not yet defined; will retry shortly');
          var attempts = 0;
          var maxAttempts = 10;
          var timer = setInterval(function(){
            if(window.RemoteSlider){ clearInterval(timer); fn(); }
            else if(++attempts >= maxAttempts){
              clearInterval(timer);
              console.error('[Demo] RemoteSlider still undefined after retries. Check network panel for remote-slider.umd.js.');
            }
          }, 300);
        }
      document.getElementById('mountBtn').addEventListener('click', () => {
        const cfg = parseConfig();
        if (!cfg) return;
          ensureReady(() => window.RemoteSlider.mount('#gallery', cfg));
      });
      document.getElementById('remountBtn').addEventListener('click', () => {
        const cfg = parseConfig();
        if (!cfg) return;
          ensureReady(() => window.RemoteSlider.remount('#gallery', cfg));
      });
      document.getElementById('unmountBtn').addEventListener('click', () => {
          if(!window.RemoteSlider){ console.warn('[Demo] RemoteSlider not loaded'); return; }
          window.RemoteSlider.unmount('#gallery');
      });
      document.addEventListener('DOMContentLoaded', () => {
        const cfg = parseConfig();
          ensureReady(() => {
            window.RemoteSlider.mount('#gallery', cfg);
            console.log('RemoteSlider ready (DOMContentLoaded):', window.RemoteSlider);
          });
      });
    </script>
  </body>
</html>
